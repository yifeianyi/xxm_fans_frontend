{"version":3,"sources":["../../../../node_modules/lucide-react/src/icons/chevron-right.ts","../../../../app/infrastructure/repositories/SongRepository.ts","../../../../app/infrastructure/mappers/SongMapper.ts","../../../../app/infrastructure/mappers/GalleryMapper.ts","../../../../app/infrastructure/repositories/GalleryRepository.ts","../../../../app/infrastructure/mappers/LivestreamMapper.ts","../../../../app/infrastructure/repositories/LivestreamRepository.ts","../../../../app/infrastructure/mappers/FansDIYMapper.ts","../../../../app/infrastructure/repositories/FansDIYRepository.ts","../../../../app/infrastructure/mappers/AnalyticsMapper.ts","../../../../app/infrastructure/repositories/AnalyticsRepository.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [['path', { d: 'm9 18 6-6-6-6', key: 'mthhwq' }]];\n\n/**\n * @component @name ChevronRight\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtOSAxOCA2LTYtNi02IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/chevron-right\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ChevronRight = createLucideIcon('chevron-right', __iconNode);\n\nexport default ChevronRight;\n","/**\n * Song 仓储实现\n * \n * 实现 ISongRepository 接口，负责歌曲数据的实际获取\n * 依赖：ApiClient, SongMapper\n * \n * @module infrastructure/repositories\n */\n\nimport { Song, SongRecord, OriginalWork, Recommendation } from '@/app/domain/types';\nimport {\n    ISongRepository,\n    GetSongsParams,\n    GetRecordsParams,\n    GetTopSongsParams,\n    PaginatedResult,\n} from '@/app/domain/repositories';\nimport { ApiClient } from '../api/base';\nimport { SongMapper } from '../mappers/SongMapper';\n\n/**\n * 歌曲仓储实现类\n */\nexport class SongRepository implements ISongRepository {\n    private apiClient: ApiClient;\n\n    constructor(apiClient?: ApiClient) {\n        this.apiClient = apiClient || new ApiClient();\n    }\n\n    /**\n     * 构建查询参数字符串\n     */\n    private buildQueryParams(params: GetSongsParams): URLSearchParams {\n        const queryParams = new URLSearchParams();\n        \n        if (params.q) queryParams.set('q', params.q);\n        if (params.page) queryParams.set('page', params.page.toString());\n        if (params.limit) queryParams.set('limit', params.limit.toString());\n        if (params.ordering) queryParams.set('ordering', params.ordering);\n        if (params.styles) queryParams.set('styles', params.styles);\n        if (params.tags) queryParams.set('tags', params.tags);\n        if (params.language) queryParams.set('language', params.language);\n        \n        return queryParams;\n    }\n\n    async getSongs(params: GetSongsParams = {}): Promise<PaginatedResult<Song>> {\n        const queryParams = this.buildQueryParams(params);\n        const result = await this.apiClient.get<any>(`/songs/?${queryParams.toString()}`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        const data = result.data;\n        \n        // 处理后端返回的分页格式\n        const results = SongMapper.fromBackendList(data.results || []);\n        \n        return {\n            total: data.total || results.length,\n            page: data.page || params.page || 1,\n            page_size: data.page_size || params.limit || 20,\n            results,\n        };\n    }\n\n    async getSongById(id: string): Promise<Song> {\n        const result = await this.apiClient.get<any>(`/songs/${id}/`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return SongMapper.fromBackend(result.data);\n    }\n\n    async getRecords(songId: string, params?: GetRecordsParams): Promise<PaginatedResult<SongRecord>> {\n        const queryParams = new URLSearchParams();\n        if (params?.page) queryParams.set('page', params.page.toString());\n        if (params?.page_size) queryParams.set('page_size', params.page_size.toString());\n\n        const result = await this.apiClient.get<any>(`/songs/${songId}/records/?${queryParams.toString()}`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        const data = result.data;\n        \n        // 兼容处理两种数据格式：分页格式 和 数组格式\n        let recordsArray: any[];\n        let totalCount: number;\n\n        if (Array.isArray(data)) {\n            recordsArray = data;\n            totalCount = data.length;\n        } else if (data.results && Array.isArray(data.results)) {\n            recordsArray = data.results;\n            totalCount = data.total || data.results.length;\n        } else {\n            console.warn('SongRepository.getRecords: unexpected data format', data);\n            return { results: [], total: 0, page: 1, page_size: 10 };\n        }\n\n        return {\n            results: SongMapper.recordListFromBackend(recordsArray, songId),\n            total: totalCount,\n            page: data.page || 1,\n            page_size: data.page_size || 10,\n        };\n    }\n\n    async getStyles(): Promise<string[]> {\n        const result = await this.apiClient.get<{ styles: string[] }>('/styles/');\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return result.data?.styles || [];\n    }\n\n    async getTags(): Promise<string[]> {\n        const result = await this.apiClient.get<{ tags: string[] }>('/tags/');\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return result.data?.tags || [];\n    }\n\n    async getTopSongs(params?: GetTopSongsParams): Promise<Song[]> {\n        const queryParams = new URLSearchParams();\n        if (params?.range) queryParams.set('range', params.range);\n        if (params?.limit) queryParams.set('limit', params.limit.toString());\n\n        const result = await this.apiClient.get<any[]>(`/top_songs/?${queryParams.toString()}`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return SongMapper.fromBackendList(result.data || []);\n    }\n\n    async getOriginalWorks(): Promise<OriginalWork[]> {\n        const result = await this.apiClient.get<any[]>('/original-works/');\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return SongMapper.originalWorkListFromBackend(result.data || []);\n    }\n\n    async getRandomSong(): Promise<Song> {\n        const result = await this.apiClient.get<any>('/random-song/');\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return SongMapper.fromBackend(result.data);\n    }\n\n    async getRecommendation(): Promise<Recommendation & { recommendedSongsDetails?: any[] }> {\n        const result = await this.apiClient.get<any>('/site-settings/');\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return SongMapper.recommendationFromBackend(result.data);\n    }\n\n    async getFilterOptions(): Promise<{ styles: string[]; tags: string[]; languages: string[] }> {\n        // 并行获取所有筛选选项\n        const [stylesResult, tagsResult] = await Promise.all([\n            this.getStyles(),\n            this.getTags(),\n        ]);\n\n        // 语种列表可以从配置或 API 获取，这里返回常见语种\n        const languages = ['国语', '粤语', '英语', '日语', '韩语', '其他'];\n\n        return {\n            styles: stylesResult,\n            tags: tagsResult,\n            languages,\n        };\n    }\n}\n\n/**\n * 默认歌曲仓储实例\n * 可以在应用启动时注入不同的实现（如 Mock、LocalStorage 等）\n */\nexport const songRepository = new SongRepository();\n","/**\n * Song 数据映射器\n * \n * 负责将后端 API 返回的原始数据转换为领域模型 (Song)\n * 集中管理所有数据转换逻辑，便于维护和测试\n * \n * @module infrastructure/mappers\n */\n\nimport { Song, SongRecord, OriginalWork, Recommendation } from '@/app/domain/types';\nimport { getFullCoverUrl } from '../api/base';\n\n/**\n * 后端歌曲数据结构（原始）\n */\ninterface BackendSongItem {\n    id?: number | string;\n    song_name?: string;\n    singer?: string;\n    styles?: string[];\n    language?: string;\n    first_perform?: string;\n    last_performed?: string;\n    last_perform?: string;\n    perform_count?: number;\n    tags?: string[];\n}\n\n/**\n * 后端演唱记录数据结构（原始）\n */\ninterface BackendRecordItem {\n    id?: number | string;\n    song_name?: string;\n    performed_at?: string;\n    cover_url?: string;\n    cover?: string;\n    cover_thumbnail_url?: string;\n    notes?: string;\n    note?: string;\n    url?: string;\n    video_url?: string;\n}\n\n/**\n * 后端原唱作品数据结构（原始）\n */\ninterface BackendOriginalWorkItem {\n    title?: string;\n    date?: string;\n    desc?: string;\n    cover?: string;\n    songId?: string;\n    song_id?: string;\n    neteaseId?: string;\n    netease_id?: string;\n    bilibiliBvid?: string;\n    bilibili_bvid?: string;\n    bvid?: string;\n    featured?: boolean;\n}\n\n/**\n * 推荐数据后端结构\n */\ninterface BackendRecommendationItem {\n    content?: string;\n    recommended_songs?: Array<{ id?: number | string; song_name?: string; singer?: string; language?: string }>;\n    recommended_songs_details?: Array<{ id?: number | string; song_name?: string; singer?: string; language?: string }>;\n    is_active?: boolean;\n}\n\n/**\n * Song 数据映射器类\n */\nexport class SongMapper {\n    /**\n     * 将后端歌曲数据转换为领域模型\n     * @param item 后端返回的原始数据\n     * @returns 领域模型 Song\n     */\n    static fromBackend(item: BackendSongItem): Song {\n        return {\n            id: item.id?.toString() || '',\n            name: item.song_name || '未知歌曲',\n            originalArtist: item.singer || '未知歌手',\n            genres: Array.isArray(item.styles) ? item.styles : [],\n            languages: item.language ? [item.language] : [],\n            firstPerformance: item.first_perform || '',\n            lastPerformance: item.last_performed || item.last_perform || '',\n            performanceCount: item.perform_count || 0,\n            tags: Array.isArray(item.tags) ? item.tags : [],\n        };\n    }\n\n    /**\n     * 批量转换后端歌曲数据\n     * @param items 后端返回的原始数据数组\n     * @returns 领域模型数组\n     */\n    static fromBackendList(items: BackendSongItem[]): Song[] {\n        if (!Array.isArray(items)) {\n            console.warn('SongMapper.fromBackendList: expected array, got', typeof items);\n            return [];\n        }\n        return items.map(item => this.fromBackend(item));\n    }\n\n    /**\n     * 将后端演唱记录数据转换为领域模型\n     * @param item 后端返回的原始数据\n     * @param songId 关联的歌曲 ID\n     * @returns 领域模型 SongRecord\n     */\n    static recordFromBackend(item: BackendRecordItem, songId: string): SongRecord {\n        const coverUrl = item.cover_url || item.cover || '';\n        \n        return {\n            id: item.id?.toString() || '',\n            songId: songId,\n            songName: item.song_name || '',\n            date: item.performed_at || '',\n            cover: getFullCoverUrl(coverUrl),\n            coverThumbnailUrl: getFullCoverUrl(item.cover_thumbnail_url || coverUrl),\n            note: item.notes || item.note || '',\n            videoUrl: item.url || item.video_url || '',\n        };\n    }\n\n    /**\n     * 批量转换后端演唱记录数据\n     * @param items 后端返回的原始数据数组\n     * @param songId 关联的歌曲 ID\n     * @returns 领域模型数组\n     */\n    static recordListFromBackend(items: BackendRecordItem[], songId: string): SongRecord[] {\n        if (!Array.isArray(items)) {\n            console.warn('SongMapper.recordListFromBackend: expected array, got', typeof items);\n            return [];\n        }\n        return items.map(item => this.recordFromBackend(item, songId));\n    }\n\n    /**\n     * 将后端原唱作品数据转换为领域模型\n     * @param item 后端返回的原始数据\n     * @returns 领域模型 OriginalWork\n     */\n    static originalWorkFromBackend(item: BackendOriginalWorkItem): OriginalWork {\n        return {\n            title: item.title || '',\n            date: item.date || '',\n            desc: item.desc || '',\n            cover: getFullCoverUrl(item.cover),\n            songId: item.songId || item.song_id || '',\n            neteaseId: item.neteaseId || item.netease_id || '',\n            bilibiliBvid: item.bilibiliBvid || item.bilibili_bvid || item.bvid || '',\n            featured: item.featured || false,\n        };\n    }\n\n    /**\n     * 批量转换后端原唱作品数据\n     * @param items 后端返回的原始数据数组\n     * @returns 领域模型数组\n     */\n    static originalWorkListFromBackend(items: BackendOriginalWorkItem[]): OriginalWork[] {\n        if (!Array.isArray(items)) {\n            console.warn('SongMapper.originalWorkListFromBackend: expected array, got', typeof items);\n            return [];\n        }\n        return items.map(item => this.originalWorkFromBackend(item));\n    }\n\n    /**\n     * 将后端推荐数据转换为领域模型\n     * @param data 后端返回的原始数据（可能是数组或对象）\n     * @returns 领域模型 Recommendation\n     */\n    static recommendationFromBackend(data: BackendRecommendationItem | BackendRecommendationItem[]): Recommendation & { recommendedSongsDetails?: any[] } {\n        // API 返回的是数组，取第一个激活的推荐\n        const recommendationData = Array.isArray(data)\n            ? data.find((r: BackendRecommendationItem) => r.is_active) || data[0]\n            : data;\n\n        if (!recommendationData) {\n            return {\n                content: '',\n                recommendedSongs: [],\n                recommendedSongsDetails: [],\n            };\n        }\n\n        const recommendedSongsDetails = recommendationData.recommended_songs_details?.map((song: any) => ({\n            id: song.id?.toString() || '',\n            name: song.song_name || '未知歌曲',\n            singer: song.singer || '未知歌手',\n            language: song.language || '未知语种',\n        })) || [];\n\n        return {\n            content: recommendationData.content || '',\n            recommendedSongs: recommendationData.recommended_songs?.map((song: any) => song.id?.toString() || '') || [],\n            recommendedSongsDetails: recommendedSongsDetails,\n        };\n    }\n\n    /**\n     * 转换排序字段（前端显示名称 -> 后端字段名）\n     * @param field 前端排序字段\n     * @returns 后端字段名\n     */\n    static mapSortField(field: string): string {\n        const fieldMap: Record<string, string> = {\n            'count': 'perform_count',\n            'first': 'first_perform',\n            'last': 'last_performed',\n            'name': 'song_name',\n            'artist': 'singer',\n        };\n        return fieldMap[field] || field;\n    }\n\n    /**\n     * 构建排序字符串\n     * @param field 排序字段\n     * @param direction 排序方向\n     * @returns 后端排序参数\n     */\n    static buildOrderingParam(field: string, direction: 'asc' | 'desc'): string {\n        const mappedField = this.mapSortField(field);\n        return direction === 'asc' ? mappedField : `-${mappedField}`;\n    }\n}\n","/**\n * Gallery 数据映射器\n * \n * 负责将后端 API 返回的原始数据转换为领域模型 (Gallery)\n * \n * @module infrastructure/mappers\n */\n\nimport { Gallery, GalleryImage, Breadcrumb } from '@/app/domain/types';\nimport { getFullCoverUrl } from '../api/base';\n\n/**\n * 后端图集数据结构（原始）\n */\ninterface BackendGalleryItem {\n    id?: number | string;\n    title?: string;\n    description?: string;\n    cover_url?: string;\n    cover_thumbnail_url?: string;\n    level?: number;\n    image_count?: number;\n    folder_path?: string;\n    tags?: string[];\n    is_leaf?: boolean;\n    children?: BackendGalleryItem[];\n    breadcrumbs?: BackendBreadcrumbItem[];\n    created_at?: string;\n}\n\n/**\n * 后端面包屑数据结构\n */\ninterface BackendBreadcrumbItem {\n    id?: number | string;\n    title?: string;\n}\n\n/**\n * 后端图片数据结构\n */\ninterface BackendImageItem {\n    id?: number | string;\n    url?: string;\n    thumbnail_url?: string;\n    title?: string;\n    filename?: string;\n    is_gif?: boolean;\n    is_video?: boolean;\n}\n\n/**\n * Gallery 数据映射器类\n */\nexport class GalleryMapper {\n    /**\n     * 将后端图集数据转换为领域模型\n     * @param item 后端返回的原始数据\n     * @returns 领域模型 Gallery\n     */\n    static fromBackend(item: BackendGalleryItem): Gallery {\n        return {\n            id: item.id?.toString() || '',\n            title: item.title || '',\n            description: item.description || '',\n            coverUrl: getFullCoverUrl(item.cover_url),\n            coverThumbnailUrl: getFullCoverUrl(item.cover_thumbnail_url || item.cover_url),\n            level: item.level || 0,\n            imageCount: item.image_count || 0,\n            folderPath: item.folder_path || '',\n            tags: Array.isArray(item.tags) ? item.tags : [],\n            isLeaf: item.is_leaf ?? true,\n            children: item.children ? this.fromBackendList(item.children) : undefined,\n            breadcrumbs: item.breadcrumbs ? this.breadcrumbsFromBackend(item.breadcrumbs) : undefined,\n            createdAt: item.created_at || '',\n        };\n    }\n\n    /**\n     * 批量转换后端图集数据\n     * @param items 后端返回的原始数据数组\n     * @returns 领域模型数组\n     */\n    static fromBackendList(items: BackendGalleryItem[]): Gallery[] {\n        if (!Array.isArray(items)) {\n            console.warn('GalleryMapper.fromBackendList: expected array, got', typeof items);\n            return [];\n        }\n        return items.map(item => this.fromBackend(item));\n    }\n\n    /**\n     * 将后端面包屑数据转换为领域模型\n     * @param items 后端返回的原始数据数组\n     * @returns 面包屑模型数组\n     */\n    static breadcrumbsFromBackend(items: BackendBreadcrumbItem[]): Breadcrumb[] {\n        if (!Array.isArray(items)) {\n            return [];\n        }\n        return items.map(item => ({\n            id: item.id?.toString() || '',\n            title: item.title || '',\n        }));\n    }\n\n    /**\n     * 将后端图片数据转换为领域模型\n     * @param item 后端返回的原始数据\n     * @returns 领域模型 GalleryImage\n     */\n    static imageFromBackend(item: BackendImageItem): GalleryImage {\n        return {\n            id: item.id?.toString() || '',\n            url: getFullCoverUrl(item.url),\n            thumbnailUrl: getFullCoverUrl(item.thumbnail_url || item.url),\n            title: item.title || '',\n            filename: item.filename || '',\n            isGif: item.is_gif || false,\n            isVideo: item.is_video || false,\n        };\n    }\n\n    /**\n     * 批量转换后端图片数据\n     * @param items 后端返回的原始数据数组\n     * @returns 领域模型数组\n     */\n    static imageListFromBackend(items: BackendImageItem[]): GalleryImage[] {\n        if (!Array.isArray(items)) {\n            console.warn('GalleryMapper.imageListFromBackend: expected array, got', typeof items);\n            return [];\n        }\n        return items.map(item => this.imageFromBackend(item));\n    }\n\n    /**\n     * 构建树形结构（用于层级展示）\n     * @param galleries 平铺的图集列表\n     * @param parentId 父级 ID（可选，用于筛选）\n     * @returns 树形结构\n     */\n    static buildTree(galleries: Gallery[], parentId?: string): Gallery[] {\n        // 这里简化处理，实际可能需要根据后端返回的 children 字段\n        if (parentId) {\n            return galleries.filter(g => g.breadcrumbs?.some(b => b.id === parentId));\n        }\n        return galleries;\n    }\n}\n","/**\n * Gallery 仓储实现\n * \n * 实现 IGalleryRepository 接口，负责图集数据的实际获取\n * \n * @module infrastructure/repositories\n */\n\nimport { Gallery, GalleryImage } from '@/app/domain/types';\nimport {\n    IGalleryRepository,\n    GetGalleriesParams,\n    GetGalleryImagesParams,\n} from '@/app/domain/repositories';\nimport { ApiClient } from '../api/base';\nimport { GalleryMapper } from '../mappers/GalleryMapper';\n\n/**\n * 图集仓储实现类\n */\nexport class GalleryRepository implements IGalleryRepository {\n    private apiClient: ApiClient;\n\n    constructor(apiClient?: ApiClient) {\n        this.apiClient = apiClient || new ApiClient();\n    }\n\n    async getGalleries(params: GetGalleriesParams = {}): Promise<Gallery[]> {\n        const queryParams = new URLSearchParams();\n        if (params.parentId) queryParams.set('parent', params.parentId);\n        if (params.page) queryParams.set('page', params.page.toString());\n        if (params.limit) queryParams.set('limit', params.limit.toString());\n\n        const result = await this.apiClient.get<any[]>(`/gallery/tree/?${queryParams.toString()}`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return GalleryMapper.fromBackendList(result.data || []);\n    }\n\n    async getGalleryById(id: string): Promise<Gallery> {\n        const result = await this.apiClient.get<any>(`/gallery/${id}/`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return GalleryMapper.fromBackend(result.data);\n    }\n\n    async getGalleryImages(\n        galleryId: string,\n        params?: GetGalleryImagesParams\n    ): Promise<{ images: GalleryImage[]; total: number }> {\n        const queryParams = new URLSearchParams();\n        if (params?.page) queryParams.set('page', params.page.toString());\n        if (params?.page_size) queryParams.set('page_size', params.page_size.toString());\n\n        const result = await this.apiClient.get<any>(`/gallery/${galleryId}/images/?${queryParams.toString()}`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        const data = result.data;\n\n        // 处理可能的数组或分页格式\n        if (Array.isArray(data)) {\n            return {\n                images: GalleryMapper.imageListFromBackend(data),\n                total: data.length,\n            };\n        }\n\n        return {\n            images: GalleryMapper.imageListFromBackend(data.images || []),\n            total: data.total || data.images?.length || 0,\n        };\n    }\n\n    async getGalleryBreadcrumbs(galleryId: string): Promise<Array<{ id: string; title: string }>> {\n        const result = await this.apiClient.get<any>(`/gallery/${galleryId}/`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        const gallery = GalleryMapper.fromBackend(result.data);\n        return gallery.breadcrumbs || [];\n    }\n\n    async syncGallery(galleryId: string): Promise<{ success: boolean; message: string }> {\n        const result = await this.apiClient.post<any>(`/gallery/${galleryId}/sync/`, {});\n\n        if (result.error) {\n            return {\n                success: false,\n                message: result.error.message || '同步失败',\n            };\n        }\n\n        return {\n            success: true,\n            message: '同步成功',\n        };\n    }\n\n    /**\n     * 获取子图集图片聚合\n     * @param galleryId 父图集 ID\n     * @returns 子图集图片分组\n     */\n    async getChildrenImages(galleryId: string): Promise<{\n        children: Array<{\n            gallery: Gallery;\n            images: GalleryImage[];\n        }>;\n        totalGalleries: number;\n        totalImages: number;\n    }> {\n        const result = await this.apiClient.get<any>(`/gallery/${galleryId}/children-images/`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        const data = result.data;\n\n        // 如果是叶子节点，返回单组数据\n        if (data.images) {\n            return {\n                children: [{\n                    gallery: GalleryMapper.fromBackend(data.gallery),\n                    images: GalleryMapper.imageListFromBackend(data.images),\n                }],\n                totalGalleries: 1,\n                totalImages: data.total || data.images.length,\n            };\n        }\n\n        // 如果是父节点，返回子图集分组\n        return {\n            children: (data.children || []).map((item: any) => ({\n                gallery: GalleryMapper.fromBackend(item.gallery),\n                images: GalleryMapper.imageListFromBackend(item.images || []),\n            })),\n            totalGalleries: data.total_galleries || 0,\n            totalImages: data.total_images || 0,\n        };\n    }\n}\n\n/**\n * 默认图集仓储实例\n */\nexport const galleryRepository = new GalleryRepository();\n","/**\n * Livestream 数据映射器\n * \n * 负责将后端 API 返回的原始数据转换为领域模型 (Livestream)\n * \n * @module infrastructure/mappers\n */\n\nimport { Livestream, SongCut, Screenshot, LivestreamRecording } from '@/app/domain/types';\nimport { getFullCoverUrl } from '../api/base';\nimport { CalendarItem, LivestreamSegment } from '@/app/domain/repositories/ILivestreamRepository';\n\n/**\n * 后端直播数据结构（原始）\n * 注意：后端可能返回 camelCase 或 snake_case 字段，需要兼容处理\n */\ninterface BackendLivestreamItem {\n    id?: number | string;\n    date?: string;\n    title?: string | null;\n    summary?: string | null;\n    // 支持两种命名格式\n    viewCount?: string | number;\n    view_count?: string | number;\n    danmakuCount?: string | number;\n    danmaku_count?: string | number;\n    startTime?: string;\n    start_time?: string;\n    endTime?: string;\n    end_time?: string;\n    duration?: string;\n    bvid?: string;\n    parts?: number;\n    // 支持两种命名格式\n    coverUrl?: string;\n    cover_url?: string;\n    recordings?: BackendRecordingItem[];\n    // 支持两种命名格式\n    songCuts?: BackendSongCutItem[];\n    song_cuts?: BackendSongCutItem[];\n    // 支持两种命名格式\n    screenshots?: BackendScreenshotItem[];\n    // 支持两种命名格式\n    danmakuCloudUrl?: string;\n    danmaku_cloud_url?: string;\n}\n\n/**\n * 后端录制数据结构\n */\ninterface BackendRecordingItem {\n    title?: string;\n    url?: string;\n}\n\n/**\n * 后端歌切数据结构\n * 支持两种命名格式\n */\ninterface BackendSongCutItem {\n    performed_at?: string;\n    song_name?: string;\n    url?: string;\n    cover_thumbnail_url?: string;\n    coverThumbnailUrl?: string;\n}\n\n/**\n * 后端截图数据结构\n * 后端返回的是 camelCase 格式\n */\ninterface BackendScreenshotItem {\n    url?: string;\n    thumbnailUrl?: string;\n    thumbnail_url?: string;\n}\n\n/**\n * 后端日历数据结构\n */\ninterface BackendCalendarItem {\n    date?: string;\n    has_livestream?: boolean;\n    livestream_id?: number | string;\n    title?: string;\n}\n\n/**\n * 后端分段视频数据结构\n */\ninterface BackendSegmentItem {\n    part?: number;\n    title?: string;\n    url?: string;\n    duration?: string;\n}\n\n/**\n * Livestream 数据映射器类\n */\nexport class LivestreamMapper {\n    /**\n     * 将后端直播数据转换为领域模型\n     * @param item 后端返回的原始数据（支持 camelCase 和 snake_case）\n     * @returns 领域模型 Livestream\n     */\n    static fromBackend(item: BackendLivestreamItem): Livestream {\n        return {\n            id: item.id?.toString() || '',\n            date: item.date || '',\n            title: item.title || undefined,\n            summary: item.summary || undefined,\n            // 兼容 camelCase 和 snake_case\n            viewCount: (item.viewCount ?? item.view_count)?.toString(),\n            danmakuCount: (item.danmakuCount ?? item.danmaku_count)?.toString(),\n            startTime: item.startTime ?? item.start_time,\n            endTime: item.endTime ?? item.end_time,\n            duration: item.duration,\n            bvid: item.bvid,\n            parts: item.parts,\n            // 兼容 camelCase 和 snake_case\n            coverUrl: getFullCoverUrl(item.coverUrl ?? item.cover_url),\n            recordings: item.recordings ? this.recordingsFromBackend(item.recordings) : undefined,\n            // 兼容 camelCase 和 snake_case\n            songCuts: this.songCutsFromBackend(item.songCuts ?? item.song_cuts),\n            // screenshots 字段已经是 camelCase，直接使用\n            screenshots: item.screenshots ? this.screenshotsFromBackend(item.screenshots) : undefined,\n            // 兼容 camelCase 和 snake_case\n            danmakuCloudUrl: item.danmakuCloudUrl ?? item.danmaku_cloud_url,\n        };\n    }\n\n    /**\n     * 批量转换后端直播数据\n     * @param items 后端返回的原始数据数组\n     * @returns 领域模型数组\n     */\n    static fromBackendList(items: BackendLivestreamItem[]): Livestream[] {\n        if (!Array.isArray(items)) {\n            console.warn('LivestreamMapper.fromBackendList: expected array, got', typeof items);\n            return [];\n        }\n        return items.map(item => this.fromBackend(item));\n    }\n\n    /**\n     * 将后端录制数据转换为领域模型\n     * @param items 后端返回的原始数据数组\n     * @returns 录制记录数组\n     */\n    static recordingsFromBackend(items: BackendRecordingItem[]): LivestreamRecording[] {\n        if (!Array.isArray(items)) {\n            return [];\n        }\n        return items.map(item => ({\n            title: item.title || '',\n            url: item.url || '',\n        }));\n    }\n\n    /**\n     * 将后端歌切数据转换为领域模型\n     * @param items 后端返回的原始数据数组（支持 camelCase 和 snake_case）\n     * @returns 歌切数组\n     */\n    static songCutsFromBackend(items?: BackendSongCutItem[] | null): SongCut[] {\n        if (!items || !Array.isArray(items)) {\n            return [];\n        }\n        return items.map(item => ({\n            performed_at: item.performed_at || '',\n            song_name: item.song_name || '',\n            url: item.url || '',\n            // 兼容 camelCase 和 snake_case\n            coverThumbnailUrl: getFullCoverUrl(item.coverThumbnailUrl ?? item.cover_thumbnail_url),\n        }));\n    }\n\n    /**\n     * 将后端截图数据转换为领域模型\n     * @param items 后端返回的原始数据数组（已是 camelCase 格式）\n     * @returns 截图数组\n     */\n    static screenshotsFromBackend(items?: BackendScreenshotItem[] | null): Screenshot[] {\n        if (!items || !Array.isArray(items)) {\n            return [];\n        }\n        return items.map(item => ({\n            url: getFullCoverUrl(item.url),\n            thumbnailUrl: getFullCoverUrl(item.thumbnailUrl ?? item.thumbnail_url ?? item.url),\n        }));\n    }\n\n    /**\n     * 将后端日历数据转换为领域模型\n     * @param items 后端返回的原始数据数组\n     * @returns 日历项数组\n     */\n    static calendarFromBackend(items: BackendCalendarItem[]): CalendarItem[] {\n        if (!Array.isArray(items)) {\n            console.warn('LivestreamMapper.calendarFromBackend: expected array, got', typeof items);\n            return [];\n        }\n        return items.map(item => ({\n            date: item.date || '',\n            hasLivestream: item.has_livestream || false,\n            livestreamId: item.livestream_id?.toString(),\n            title: item.title,\n        }));\n    }\n\n    /**\n     * 将后端分段视频数据转换为领域模型\n     * @param items 后端返回的原始数据数组\n     * @returns 分段视频数组\n     */\n    static segmentsFromBackend(items: BackendSegmentItem[]): LivestreamSegment[] {\n        if (!Array.isArray(items)) {\n            return [];\n        }\n        return items.map(item => ({\n            part: item.part || 1,\n            title: item.title || '',\n            url: item.url || '',\n            duration: item.duration,\n        }));\n    }\n\n    /**\n     * 格式化直播时长\n     * @param duration ISO 8601 格式的时长字符串\n     * @returns 格式化后的时长字符串 (如 \"2小时30分钟\")\n     */\n    static formatDuration(duration?: string): string {\n        if (!duration) return '';\n        \n        // 简单的时长解析，实际可能需要更复杂的逻辑\n        const match = duration.match(/PT(?:(\\d+)H)?(?:(\\d+)M)?(?:(\\d+)S)?/);\n        if (!match) return duration;\n        \n        const hours = parseInt(match[1] || '0');\n        const minutes = parseInt(match[2] || '0');\n        const seconds = parseInt(match[3] || '0');\n        \n        const parts: string[] = [];\n        if (hours > 0) parts.push(`${hours}小时`);\n        if (minutes > 0) parts.push(`${minutes}分钟`);\n        if (seconds > 0 && hours === 0) parts.push(`${seconds}秒`);\n        \n        return parts.join('') || duration;\n    }\n}\n","/**\n * Livestream 仓储实现\n * \n * 实现 ILivestreamRepository 接口，负责直播数据的实际获取\n * \n * @module infrastructure/repositories\n */\n\nimport { Livestream, SongCut, Screenshot } from '@/app/domain/types';\nimport {\n    ILivestreamRepository,\n    GetLivestreamsParams,\n    CalendarItem,\n    LivestreamSegment,\n} from '@/app/domain/repositories';\nimport { ApiClient } from '../api/base';\nimport { LivestreamMapper } from '../mappers/LivestreamMapper';\n\n/**\n * 直播仓储实现类\n */\nexport class LivestreamRepository implements ILivestreamRepository {\n    private apiClient: ApiClient;\n\n    constructor(apiClient?: ApiClient) {\n        this.apiClient = apiClient || new ApiClient();\n    }\n\n    async getLivestreams(params: GetLivestreamsParams = {}): Promise<{\n        livestreams: Livestream[];\n        total: number;\n    }> {\n        const queryParams = new URLSearchParams();\n        if (params.page) queryParams.set('page', params.page.toString());\n        if (params.limit) queryParams.set('limit', params.limit.toString());\n        if (params.year) queryParams.set('year', params.year.toString());\n        if (params.month) queryParams.set('month', params.month.toString());\n\n        // 使用正确的后端 API 端点：/livestreams/ (复数)\n        const result = await this.apiClient.get<any>(`/livestreams/?${queryParams.toString()}`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        const data = result.data;\n\n        // 处理后端统一响应格式: { code, message, data }\n        // data 可能是数组或 { results: [...], total: N }\n        let actualData = data;\n        if (data && typeof data === 'object' && 'code' in data) {\n            actualData = data.data;\n        }\n\n        // 处理可能的数组或分页格式\n        if (Array.isArray(actualData)) {\n            return {\n                livestreams: LivestreamMapper.fromBackendList(actualData),\n                total: actualData.length,\n            };\n        }\n\n        return {\n            livestreams: LivestreamMapper.fromBackendList(actualData?.results || []),\n            total: actualData?.total || actualData?.results?.length || 0,\n        };\n    }\n\n    async getLivestreamById(id: string): Promise<Livestream> {\n        const result = await this.apiClient.get<any>(`/livestreams/${id}/`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        // 处理后端统一响应格式\n        const data = result.data?.data || result.data;\n        return LivestreamMapper.fromBackend(data);\n    }\n\n    /**\n     * 根据日期获取直播详情（包含截图、歌切等）\n     * 后端 API: GET /livestreams/{date}/ 返回完整详情\n     */\n    async getLivestreamByDate(dateStr: string): Promise<Livestream | null> {\n        const result = await this.apiClient.get<any>(`/livestreams/${dateStr}/`);\n\n        if (result.error) {\n            if (result.error.message?.includes('404')) {\n                return null;\n            }\n            throw result.error;\n        }\n\n        // 处理后端统一响应格式: { code, message, data }\n        const data = result.data?.data !== undefined ? result.data.data : result.data;\n        \n        // 后端返回 null 表示该日期无直播记录\n        if (!data) {\n            return null;\n        }\n\n        return LivestreamMapper.fromBackend(data);\n    }\n\n    async getCalendar(year: number, month: number): Promise<CalendarItem[]> {\n        // 后端暂无专门的 calendar 端点，使用 getLivestreams 获取\n        const result = await this.getLivestreams({ year, month });\n        return result.livestreams.map(live => ({\n            date: live.date,\n            hasLivestream: true,\n            livestreamId: live.id,\n            title: live.title,\n        }));\n    }\n\n    async getSegments(livestreamId: string): Promise<LivestreamSegment[]> {\n        // 后端暂无独立的 segments 端点，segments 包含在详情中\n        // 这个方法可以保留用于未来扩展\n        const result = await this.apiClient.get<any[]>(`/livestreams/${livestreamId}/segments/`);\n\n        if (result.error) {\n            // 如果端点不存在，返回空数组\n            return [];\n        }\n\n        return LivestreamMapper.segmentsFromBackend(result.data || []);\n    }\n\n    async getSongCuts(livestreamId: string): Promise<SongCut[]> {\n        // 后端暂无独立的 song-cuts 端点，songCuts 包含在详情中\n        // 这个方法可以保留用于未来扩展\n        const result = await this.apiClient.get<any[]>(`/livestreams/${livestreamId}/song-cuts/`);\n\n        if (result.error) {\n            return [];\n        }\n\n        return LivestreamMapper.songCutsFromBackend(result.data || []);\n    }\n\n    async getScreenshots(livestreamId: string): Promise<Screenshot[]> {\n        // 后端暂无独立的 screenshots 端点，screenshots 包含在详情中\n        // 这个方法可以保留用于未来扩展\n        const result = await this.apiClient.get<any[]>(`/livestreams/${livestreamId}/screenshots/`);\n\n        if (result.error) {\n            return [];\n        }\n\n        return LivestreamMapper.screenshotsFromBackend(result.data || []);\n    }\n\n    async getRecentLivestreams(limit: number = 5): Promise<Livestream[]> {\n        const result = await this.apiClient.get<any>(`/livestreams/?limit=${limit}&ordering=-date`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        // 处理后端统一响应格式\n        const data = result.data?.data !== undefined ? result.data.data : result.data;\n\n        if (Array.isArray(data)) {\n            return LivestreamMapper.fromBackendList(data);\n        }\n\n        return LivestreamMapper.fromBackendList(data?.results || []);\n    }\n\n    async getConfig(): Promise<{ minYear: number }> {\n        const result = await this.apiClient.get<any>('/livestreams/config/');\n\n        if (result.error) {\n            // 如果获取失败，返回默认值\n            return { minYear: 2019 };\n        }\n\n        // 处理后端统一响应格式\n        const data = result.data?.data !== undefined ? result.data.data : result.data;\n        \n        return {\n            minYear: data?.minYear || 2019\n        };\n    }\n}\n\n/**\n * 默认直播仓储实例\n */\nexport const livestreamRepository = new LivestreamRepository();\n","/**\n * FansDIY 数据映射器\n * \n * 负责将后端 API 返回的原始数据转换为领域模型 (FanWork, FanCollection)\n * \n * @module infrastructure/mappers\n */\n\nimport { FanWork, FanCollection } from '@/app/domain/types';\nimport { getFullCoverUrl } from '../api/base';\n\n/**\n * 后端合集数据结构（原始）\n */\ninterface BackendCollectionItem {\n    id?: number | string;\n    name?: string;\n    description?: string;\n    works_count?: number;\n}\n\n/**\n * 后端作品数据结构（原始）\n */\ninterface BackendWorkItem {\n    id?: number | string;\n    title?: string;\n    author?: string;\n    cover?: string;\n    cover_thumbnail_url?: string;\n    video_url?: string;\n    note?: string;\n    collection_id?: number | string;\n    position?: number;\n}\n\n/**\n * FansDIY 数据映射器类\n */\nexport class FansDIYMapper {\n    /**\n     * 将后端合集数据转换为领域模型\n     * @param item 后端返回的原始数据\n     * @returns 领域模型 FanCollection\n     */\n    static collectionFromBackend(item: BackendCollectionItem): FanCollection {\n        return {\n            id: item.id?.toString() || '',\n            name: item.name || '',\n            description: item.description || '',\n            worksCount: item.works_count || 0,\n        };\n    }\n\n    /**\n     * 批量转换后端合集数据\n     * @param items 后端返回的原始数据数组\n     * @returns 领域模型数组\n     */\n    static collectionListFromBackend(items: BackendCollectionItem[]): FanCollection[] {\n        if (!Array.isArray(items)) {\n            console.warn('FansDIYMapper.collectionListFromBackend: expected array, got', typeof items);\n            return [];\n        }\n        return items.map(item => this.collectionFromBackend(item));\n    }\n\n    /**\n     * 将后端作品数据转换为领域模型\n     * @param item 后端返回的原始数据\n     * @returns 领域模型 FanWork\n     */\n    static workFromBackend(item: BackendWorkItem): FanWork {\n        const coverUrl = item.cover || '';\n        \n        return {\n            id: item.id?.toString() || '',\n            title: item.title || '',\n            author: item.author || '',\n            cover: getFullCoverUrl(coverUrl),\n            coverThumbnailUrl: getFullCoverUrl(item.cover_thumbnail_url || coverUrl),\n            videoUrl: item.video_url || '',\n            note: item.note || '',\n            collectionId: item.collection_id?.toString() || '',\n            position: item.position || 0,\n        };\n    }\n\n    /**\n     * 批量转换后端作品数据\n     * @param items 后端返回的原始数据数组\n     * @returns 领域模型数组\n     */\n    static workListFromBackend(items: BackendWorkItem[]): FanWork[] {\n        if (!Array.isArray(items)) {\n            console.warn('FansDIYMapper.workListFromBackend: expected array, got', typeof items);\n            return [];\n        }\n        return items.map(item => this.workFromBackend(item));\n    }\n}\n","/**\n * FansDIY 仓储实现\n * \n * 实现 IFansDIYRepository 接口，负责粉丝二创数据的实际获取\n * \n * @module infrastructure/repositories\n */\n\nimport { FanWork, FanCollection } from '@/app/domain/types';\nimport {\n    IFansDIYRepository,\n    GetCollectionsParams,\n    GetWorksParams,\n} from '@/app/domain/repositories';\nimport { ApiClient } from '../api/base';\nimport { FansDIYMapper } from '../mappers/FansDIYMapper';\n\n/**\n * 粉丝二创仓储实现类\n */\nexport class FansDIYRepository implements IFansDIYRepository {\n    private apiClient: ApiClient;\n\n    constructor(apiClient?: ApiClient) {\n        this.apiClient = apiClient || new ApiClient();\n    }\n\n    async getCollections(params: GetCollectionsParams = {}): Promise<{\n        collections: FanCollection[];\n        total: number;\n    }> {\n        const queryParams = new URLSearchParams();\n        if (params.page) queryParams.set('page', params.page.toString());\n        if (params.limit) queryParams.set('limit', params.limit.toString());\n\n        const result = await this.apiClient.get<any>(`/fansDIY/collections/?${queryParams.toString()}`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        const data = result.data;\n\n        if (Array.isArray(data)) {\n            return {\n                collections: FansDIYMapper.collectionListFromBackend(data),\n                total: data.length,\n            };\n        }\n\n        return {\n            collections: FansDIYMapper.collectionListFromBackend(data.results || []),\n            total: data.total || data.results?.length || 0,\n        };\n    }\n\n    async getCollectionById(id: string): Promise<FanCollection> {\n        const result = await this.apiClient.get<any>(`/fansDIY/collections/${id}/`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return FansDIYMapper.collectionFromBackend(result.data);\n    }\n\n    async getWorks(params: GetWorksParams = {}): Promise<{\n        works: FanWork[];\n        total: number;\n    }> {\n        const queryParams = new URLSearchParams();\n        if (params.page) queryParams.set('page', params.page.toString());\n        if (params.limit) queryParams.set('limit', params.limit.toString());\n        if (params.collection) queryParams.set('collection', params.collection);\n\n        const result = await this.apiClient.get<any>(`/fansDIY/works/?${queryParams.toString()}`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        const data = result.data;\n\n        if (Array.isArray(data)) {\n            return {\n                works: FansDIYMapper.workListFromBackend(data),\n                total: data.length,\n            };\n        }\n\n        return {\n            works: FansDIYMapper.workListFromBackend(data.results || []),\n            total: data.total || data.results?.length || 0,\n        };\n    }\n\n    async getWorkById(id: string): Promise<FanWork> {\n        const result = await this.apiClient.get<any>(`/fansDIY/works/${id}/`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return FansDIYMapper.workFromBackend(result.data);\n    }\n\n    async getWorksByCollection(\n        collectionId: string,\n        params: Omit<GetWorksParams, 'collection'> = {}\n    ): Promise<{\n        works: FanWork[];\n        total: number;\n    }> {\n        // 复用 getWorks，传入 collection 参数\n        return this.getWorks({ ...params, collection: collectionId });\n    }\n}\n\n/**\n * 默认粉丝二创仓储实例\n */\nexport const fansDIYRepository = new FansDIYRepository();\n","/**\n * Analytics 数据映射器\n * \n * 负责将后端 API 返回的原始数据转换为领域模型 (AccountData, VideoStats, CorrelationData)\n * \n * @module infrastructure/mappers\n */\n\nimport { AccountData, VideoStats, CorrelationData, DataPoint, TimeGranularity } from '@/app/domain/types';\nimport { FollowerOverview } from '@/app/domain/repositories/IAnalyticsRepository';\nimport { getFullCoverUrl } from '../api/base';\n\n/**\n * 后端数据点结构\n */\ninterface BackendDataPoint {\n    time?: string;\n    value?: number;\n    delta?: number;\n}\n\n/**\n * 后端账号数据结构\n */\ninterface BackendAccountData {\n    id?: number | string;\n    name?: string;\n    total_followers?: number;\n    totalFollowers?: number;\n    history?: Record<string, BackendDataPoint[]>;\n}\n\n/**\n * 后端视频数据结构\n */\ninterface BackendVideoStats {\n    id?: number | string;\n    title?: string;\n    cover?: string;\n    publish_time?: string;\n    duration?: string;\n    views?: number;\n    guest_ratio?: number;\n    fan_watch_rate?: number;\n    follower_growth?: number;\n    likes?: number;\n    comments?: number;\n    danmaku?: number;\n    favs?: number;\n    metrics?: Record<string, {\n        views?: BackendDataPoint[];\n        likes?: BackendDataPoint[];\n        danmaku?: BackendDataPoint[];\n    }>;\n}\n\n/**\n * 后端相关性数据结构\n */\ninterface BackendCorrelationData {\n    time?: string;\n    video_view_delta?: number;\n    follower_delta?: number;\n}\n\n/**\n * 后端账号列表项\n */\ninterface BackendAccountItem {\n    id?: number | string;\n    name?: string;\n    platform?: string;\n}\n\n/**\n * 后端粉丝数概览\n */\ninterface BackendFollowerOverview {\n    total_followers?: number;\n    today_growth?: number;\n    week_growth?: number;\n    month_growth?: number;\n}\n\n/**\n * Analytics 数据映射器类\n */\nexport class AnalyticsMapper {\n    /**\n     * 将后端数据点转换为领域模型\n     * @param item 后端返回的原始数据\n     * @returns 领域模型 DataPoint\n     */\n    static dataPointFromBackend(item: BackendDataPoint): DataPoint {\n        return {\n            time: item.time || '',\n            value: item.value || 0,\n            delta: item.delta || 0,\n        };\n    }\n\n    /**\n     * 批量转换后端数据点\n     * @param items 后端返回的原始数据数组\n     * @returns 领域模型数组\n     */\n    static dataPointListFromBackend(items: BackendDataPoint[]): DataPoint[] {\n        if (!Array.isArray(items)) {\n            return [];\n        }\n        return items.map(item => this.dataPointFromBackend(item));\n    }\n\n    /**\n     * 转换时间粒度历史数据\n     * @param history 后端返回的历史数据\n     * @returns 转换后的历史数据\n     */\n    static historyFromBackend(history?: Record<string, BackendDataPoint[]>): Record<TimeGranularity, DataPoint[]> {\n        if (!history || typeof history !== 'object') {\n            return { DAY: [], WEEK: [], MONTH: [] };\n        }\n\n        const result: Record<TimeGranularity, DataPoint[]> = { DAY: [], WEEK: [], MONTH: [] };\n        \n        for (const [key, value] of Object.entries(history)) {\n            const granularity = key.toUpperCase() as TimeGranularity;\n            if (granularity in result) {\n                result[granularity] = this.dataPointListFromBackend(value);\n            }\n        }\n        \n        return result;\n    }\n\n    /**\n     * 将后端账号数据转换为领域模型\n     * @param item 后端返回的原始数据\n     * @returns 领域模型 AccountData\n     */\n    static accountDataFromBackend(item: BackendAccountData): AccountData {\n        return {\n            id: item.id?.toString() || '',\n            name: item.name || '',\n            totalFollowers: item.totalFollowers || item.total_followers || 0,\n            history: this.historyFromBackend(item.history),\n        };\n    }\n\n    /**\n     * 批量转换后端账号数据\n     * @param items 后端返回的原始数据数组\n     * @returns 领域模型数组\n     */\n    static accountDataListFromBackend(items: BackendAccountData[]): AccountData[] {\n        if (!Array.isArray(items)) {\n            return [];\n        }\n        return items.map(item => this.accountDataFromBackend(item));\n    }\n\n    /**\n     * 将后端视频数据转换为领域模型\n     * @param item 后端返回的原始数据\n     * @returns 领域模型 VideoStats\n     */\n    static videoStatsFromBackend(item: BackendVideoStats): VideoStats {\n        // 转换指标数据\n        const metrics: VideoStats['metrics'] = { \n            DAY: { views: [], likes: [], danmaku: [] },\n            WEEK: { views: [], likes: [], danmaku: [] },\n            MONTH: { views: [], likes: [], danmaku: [] },\n        };\n        \n        if (item.metrics) {\n            for (const [key, value] of Object.entries(item.metrics)) {\n                const granularity = key.toUpperCase() as TimeGranularity;\n                metrics[granularity] = {\n                    views: this.dataPointListFromBackend(value.views || []),\n                    likes: this.dataPointListFromBackend(value.likes || []),\n                    danmaku: this.dataPointListFromBackend(value.danmaku || []),\n                };\n            }\n        }\n\n        return {\n            id: item.id?.toString() || '',\n            title: item.title || '',\n            cover: getFullCoverUrl(item.cover),\n            publishTime: item.publish_time || '',\n            duration: item.duration || '',\n            views: item.views || 0,\n            guestRatio: item.guest_ratio || 0,\n            fanWatchRate: item.fan_watch_rate || 0,\n            followerGrowth: item.follower_growth || 0,\n            likes: item.likes || 0,\n            comments: item.comments || 0,\n            danmaku: item.danmaku || 0,\n            favs: item.favs || 0,\n            metrics,\n        };\n    }\n\n    /**\n     * 批量转换后端视频数据\n     * @param items 后端返回的原始数据数组\n     * @returns 领域模型数组\n     */\n    static videoStatsListFromBackend(items: BackendVideoStats[]): VideoStats[] {\n        if (!Array.isArray(items)) {\n            console.warn('AnalyticsMapper.videoStatsListFromBackend: expected array, got', typeof items);\n            return [];\n        }\n        return items.map(item => this.videoStatsFromBackend(item));\n    }\n\n    /**\n     * 将后端相关性数据转换为领域模型\n     * @param item 后端返回的原始数据\n     * @returns 领域模型 CorrelationData\n     */\n    static correlationDataFromBackend(item: BackendCorrelationData): CorrelationData {\n        return {\n            time: item.time || '',\n            videoViewDelta: item.video_view_delta || 0,\n            followerDelta: item.follower_delta || 0,\n        };\n    }\n\n    /**\n     * 批量转换后端相关性数据\n     * @param items 后端返回的原始数据数组\n     * @returns 领域模型数组\n     */\n    static correlationDataListFromBackend(items: BackendCorrelationData[]): CorrelationData[] {\n        if (!Array.isArray(items)) {\n            return [];\n        }\n        return items.map(item => this.correlationDataFromBackend(item));\n    }\n\n    /**\n     * 将后端账号列表项转换为标准格式\n     * @param item 后端返回的原始数据\n     * @returns 标准化账号信息\n     */\n    static accountItemFromBackend(item: BackendAccountItem): { id: string; name: string; platform: string } {\n        return {\n            id: item.id?.toString() || '',\n            name: item.name || '',\n            platform: item.platform || '',\n        };\n    }\n\n    /**\n     * 将后端粉丝数概览转换为领域模型\n     * @param item 后端返回的原始数据\n     * @returns 领域模型 FollowerOverview\n     */\n    static followerOverviewFromBackend(item?: BackendFollowerOverview): FollowerOverview {\n        if (!item) {\n            return {\n                totalFollowers: 0,\n                todayGrowth: 0,\n                weekGrowth: 0,\n                monthGrowth: 0,\n            };\n        }\n\n        return {\n            totalFollowers: item.total_followers || 0,\n            todayGrowth: item.today_growth || 0,\n            weekGrowth: item.week_growth || 0,\n            monthGrowth: item.month_growth || 0,\n        };\n    }\n\n    /**\n     * 格式化数字（如 1.2k, 3.4M）\n     * @param num 数字\n     * @returns 格式化后的字符串\n     */\n    static formatNumber(num: number): string {\n        if (num >= 1000000) {\n            return (num / 1000000).toFixed(1) + 'M';\n        }\n        if (num >= 1000) {\n            return (num / 1000).toFixed(1) + 'k';\n        }\n        return num.toString();\n    }\n}\n","/**\n * Analytics 仓储实现\n * \n * 实现 IAnalyticsRepository 接口，负责数据分析数据的实际获取\n * \n * @module infrastructure/repositories\n */\n\nimport { AccountData, VideoStats, CorrelationData, TimeGranularity } from '@/app/domain/types';\nimport {\n    IAnalyticsRepository,\n    GetAccountDataParams,\n    GetVideoStatsParams,\n    FollowerOverview,\n} from '@/app/domain/repositories';\nimport { ApiClient } from '../api/base';\nimport { AnalyticsMapper } from '../mappers/AnalyticsMapper';\n\n/**\n * 数据分析仓储实现类\n */\nexport class AnalyticsRepository implements IAnalyticsRepository {\n    private apiClient: ApiClient;\n\n    constructor(apiClient?: ApiClient) {\n        this.apiClient = apiClient || new ApiClient();\n    }\n\n    async getAccounts(): Promise<Array<{ id: string; name: string; platform: string }>> {\n        const result = await this.apiClient.get<any[]>('/data-analytics/followers/accounts/');\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return (result.data || []).map(item => AnalyticsMapper.accountItemFromBackend(item));\n    }\n\n    async getAllAccountsData(granularity: TimeGranularity = 'WEEK', days: number = 30): Promise<AccountData[]> {\n        const queryParams = new URLSearchParams();\n        queryParams.set('granularity', granularity);\n        queryParams.set('days', days.toString());\n\n        const result = await this.apiClient.get<any>(`/data-analytics/followers/accounts/data/?${queryParams.toString()}`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return AnalyticsMapper.accountDataListFromBackend(result.data || []);\n    }\n\n    async getAccountData(params: GetAccountDataParams): Promise<AccountData> {\n        const queryParams = new URLSearchParams();\n        queryParams.set('account_id', params.accountId);\n        if (params.granularity) queryParams.set('granularity', params.granularity);\n        \n        // 根据粒度设置合适的 days 参数\n        // 注意：后端对于 DAY 粒度使用 hours 计算，所以需要传 720 (30天) 而不是 30\n        let days = 30;\n        if (params.granularity === 'DAY') {\n            days = 720; // 30 天 * 24 小时\n        }\n        queryParams.set('days', days.toString());\n        \n        if (params.startDate) queryParams.set('start_date', params.startDate);\n        if (params.endDate) queryParams.set('end_date', params.endDate);\n\n        const result = await this.apiClient.get<any>(`/data-analytics/followers/accounts/${params.accountId}/?${queryParams.toString()}`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return AnalyticsMapper.accountDataFromBackend(result.data);\n    }\n\n    async getFollowerOverview(): Promise<FollowerOverview> {\n        const result = await this.apiClient.get<any>('/data-analytics/followers/overview/');\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return AnalyticsMapper.followerOverviewFromBackend(result.data);\n    }\n\n    async getVideoStats(params: GetVideoStatsParams): Promise<VideoStats> {\n        const queryParams = new URLSearchParams();\n        if (params.granularity) queryParams.set('granularity', params.granularity);\n\n        const result = await this.apiClient.get<any>(`/data-analytics/works/bilibili/${params.videoId}/metrics/?${queryParams.toString()}`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return AnalyticsMapper.videoStatsFromBackend(result.data);\n    }\n\n    async getVideos(params?: {\n        page?: number;\n        limit?: number;\n        sortBy?: 'views' | 'likes' | 'publishTime';\n    }): Promise<{\n        videos: VideoStats[];\n        total: number;\n    }> {\n        const queryParams = new URLSearchParams();\n        if (params?.page) queryParams.set('page', params.page.toString());\n        if (params?.limit) queryParams.set('limit', params.limit.toString());\n        if (params?.sortBy) queryParams.set('sort_by', params.sortBy);\n\n        const result = await this.apiClient.get<any>(`/data-analytics/works/?${queryParams.toString()}`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        const data = result.data;\n\n        if (Array.isArray(data)) {\n            return {\n                videos: AnalyticsMapper.videoStatsListFromBackend(data),\n                total: data.length,\n            };\n        }\n\n        return {\n            videos: AnalyticsMapper.videoStatsListFromBackend(data.results || []),\n            total: data.total || data.results?.length || 0,\n        };\n    }\n\n    async getCorrelationData(params?: {\n        startDate?: string;\n        endDate?: string;\n    }): Promise<CorrelationData[]> {\n        const queryParams = new URLSearchParams();\n        if (params?.startDate) queryParams.set('start_date', params.startDate);\n        if (params?.endDate) queryParams.set('end_date', params.endDate);\n\n        const result = await this.apiClient.get<any[]>(`/data-analytics/platform/bilibili/correlation/?${queryParams.toString()}`);\n\n        if (result.error) {\n            throw result.error;\n        }\n\n        return AnalyticsMapper.correlationDataListFromBackend(result.data || []);\n    }\n}\n\n/**\n * 默认数据分析仓储实例\n */\nexport const analyticsRepository = new AnalyticsRepository();\n"],"names":[],"mappings":"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","ignoreList":[0]}